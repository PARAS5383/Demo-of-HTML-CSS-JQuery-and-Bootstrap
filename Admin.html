<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
    .row {
      --bs-gutter-x: 0rem;
    }

    .login-bg,
    .background {
      background-color: #00000080;
      border-radius: 25px;
    }

    .fa {
      color: yellow;
      z-index: 1;
      display: inline-block;
    }

    .heading {
      color: rgb(0, 255, 191);
    }
  </style>
</head>

<body>
  <div
    style="background-image: url('photos/Header_background.jpg'); height: 100%; min-height: 990px; background-repeat: no-repeat; background-size: cover; background-position: center;">
    <div id="loginId" class="row justify-content-center ">
      <div
        class="login-bg  m-5 p-5 col-xxl-3 col-xl-4 col-lg-5 col-md-6 col-sm-8 col-11 align-items-center justify-content-center text-light">
        <h3 class="text-center text-info">Admin Details</h3>
        <div class="d-flex justify-content-center" id="namedivId">
          <p>Username:&nbsp;&nbsp;</p>
          <p id="usernameId"></p>
        </div>
        <div class="d-flex justify-content-center">
          <p>Name:&nbsp;&nbsp;</p>
          <p id="nameId"></p>
        </div>
        <div class="d-flex justify-content-center">
          <p>Password:&nbsp;&nbsp;</p>
          <p id="passwordId"></p>
        </div>
        <h5 class="mt-2 text-center"><a class="text-decoration-none text-success" onclick="backHome()">Home</a></h5>
      </div>
      <h1 class="heading text-center ">User Data</h1>
    </div>

    <div class="background">
      <div class="d-flex row justify-content-between text-light">
        <label class="mt-5 col-lg-3 " for="page">Show entries:<input id="page">
          <button class="btn btn-warning" onclick="pagination()">OK</button></label>
        <label class="mt-5 ms-6 d-flex justify-content-end mb-3 col-lg-3" for="search">Search:
          <input id="search" onkeyup="find()"></label>
      </div>
      <div class="mt-5">
        <div class="table-responsive">
          <table id="table-id" class="table text-center text-light">
            <thead>
              <tr>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">ID&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="idUp" onclick="idAscending()">&#xf0de;</i><i
                        class="fa col-12" id="idDown" onclick="idDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Username&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="usernameUp" onclick="usernameAscending()">&#xf0de;</i><i
                        class="fa col-12" id="usernameDown" onclick="usernameDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Studentname&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="studentnameUp" onclick="snameAscending()">&#xf0de;</i><i
                        class="fa col-12" id="studentDown" onclick="snameDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Age&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="userageUp" onclick="ageAscending()">&#xf0de;</i><i
                        class="fa col-12" id="userageDown" onclick="ageDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Gender&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="usergenderUp" onclick="genderAscending()">&#xf0de;</i><i
                        class="fa col-12" id="usergenderDown" onclick="genderDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Starting Date&nbsp;&nbsp;
                    </spna>
                    <div class="col-5"><i class="fa col-12" id="sdateUp" onclick="sdateAscending()">&#xf0de;</i><i
                        class="fa col-12" id="sdateDown" onclick="sdateDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Ending Date&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="edateUp" onclick="edateAscending()">&#xf0de;</i><i
                        class="fa col-12" id="edateDown" onclick="edateDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
                <th>
                  <div class="row">
                    <spna class="col-6 d-flex align-items-center justify-content-center">Plan Name&nbsp;&nbsp;</spna>
                    <div class="col-5"><i class="fa col-12" id="pnameUp" onclick="pnameAscending()">&#xf0de;</i><i
                        class="fa col-12" id="pnameDown" onclick="pnameDescending()">&#xf0dd;</i></div>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
        <div class="d-flex row justify-content-between text-light">
          <div id="countRow" class="mb-4 ms-2 col-lg-12"></div>
          <div class="col-lg-12">
            <div class="btn-group me-2" role="group" id="addPrevbutton"></div>
            <div class="btn-group me-2" role="group" id="addButton"></div>
            <div class="btn-group me-2" role="group" id="addNextbutton"></div>
          </div>
        </div>

      </div>
    </div>
</body>

</html>
<script>

  // fecth data of user from local storage and call append function
  const urlParams = window.location.href;
  userName = urlParams.split('?')[1];
  $.get("Data/admin.json", function (data, status, xhr) {
    for (var j = 0; j < data.length; j++) {
      dataEntry = data[j];
      if (dataEntry.username == userName) {
        username = dataEntry.username;
        name = dataEntry.name;
        userPass = dataEntry.password;
        $("#usernameId").html(username);
        $("#nameId").html(name);
        $("#passwordId").html(userPass);
      };
    };
  });

  // Define Global Variable 
  let tempObjectstore = [];
  let dataGlobal;
  let count = 0;
  var dataLength;
  var pageCount;

  // Common data add from localfile file
  let data = [];
  for (i = 1; i <= localStorage.length; i++) {
    let obj = JSON.parse(localStorage.getItem(i));
    data.push(obj);
  };
  dataLength = data.length;
  dataGlobal = data;
  commonFunction(data);

  // Id ascending function
  function idAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.id < b.id) ? -1 : ((a.id < b.id) ? 1 : 0));
    commonFunction(data);
  };

  // Id descending function
  function idDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.id > b.id) ? -1 : ((a.id > b.id) ? 1 : 0));
    commonFunction(data);
  };

  // Username ascending function
  function usernameAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.user_name < b.user_name) ? -1 : ((a.user_name < b.user_name) ? 1 : 0));
    commonFunction(data);
  };

  // Username descending function
  function usernameDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.user_name > b.user_name) ? -1 : ((a.user_name > b.user_name) ? 1 : 0));
    commonFunction(data);
  };

  // student_name ascending function
  function snameAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.student_name < b.student_name) ? -1 : ((a.student_name < b.student_name) ? 1 : 0));
    commonFunction(data);
  };

  // student_name descending function
  function snameDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.student_name > b.student_name) ? -1 : ((a.student_name > b.student_name) ? 1 : 0));
    commonFunction(data);
  };

  // Age ascending function
  function ageAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.age < b.age) ? -1 : ((a.age < b.age) ? 1 : 0));
    commonFunction(data);
  };

  // Age descending function
  function ageDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.age > b.age) ? -1 : ((a.age > b.age) ? 1 : 0));
    commonFunction(data);
  };

  // Gender ascending function
  function genderAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.gender < b.gender) ? -1 : ((a.gender < b.gender) ? 1 : 0));
    commonFunction(data);
  };

  // Gender decending funcation
  function genderDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.gender > b.gender) ? -1 : ((a.gender > b.gender) ? 1 : 0));
    commonFunction(data);
  };

  // Starting date ascending function
  function sdateAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.starting_Date < b.starting_Date) ? -1 : ((a.starting_Date < b.starting_Date) ? 1 : 0));
    commonFunction(data);
  };

  // Starting date decending funcation
  function sdateDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.starting_Date > b.starting_Date) ? -1 : ((a.starting_Date > b.starting_Date) ? 1 : 0));
    commonFunction(data);
  };

  // Ending date ascending function
  function edateAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.ending_Date < b.ending_Date) ? -1 : ((a.ending_Date < b.ending_Date) ? 1 : 0));
    commonFunction(data);
  };

  // Ending date decending funcation
  function edateDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.ending_Date > b.ending_Date) ? -1 : ((a.ending_Date > b.ending_Date) ? 1 : 0));
    commonFunction(data);
  };

  // Plan name ascending function
  function pnameAscending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.plan_name < b.plan_name) ? -1 : ((a.plan_name < b.plan_name) ? 1 : 0));
    commonFunction(data);
  };

  // Plan name decending funcation
  function pnameDescending(parameterPass) {
    if (parameterPass == true) {
      var data = tempObjectstore;
    }
    else {
      data = dataGlobal;
    }
    $("#tbody").empty();
    data.sort((a, b) => (a.plan_name > b.plan_name) ? -1 : ((a.plan_name > b.plan_name) ? 1 : 0));
    commonFunction(data);
  };

  // Filter function
  function find(parameterPass) {
    if (parameterPass == true) {
      pageData = [];
      $("#tbody").empty();
      tempObjectstore.findIndex(function (entry, i) {
        if (entry.id.includes($("#search").val()) == true || entry.user_name.includes($("#search").val()) == true || entry.student_name.includes($("#search").val()) == true || entry.age.includes($("#search").val()) == true || entry.gender.includes($("#search").val()) == true || entry.starting_Date.includes($("#search").val()) == true || entry.ending_Date.includes($("#search").val()) == true || entry.plan_name.includes($("#search").val()) == true) {
          pageData.push(entry);

        };
      });
      data = pageData;
      tempObjectstore = pageData;
      commonFunction(data);
      changeClickfunctionT();
      pagination(true);
    }
    else {
      $("#tbody").empty();
      tempObjectstore = [];
      dataGlobal.findIndex(function (entry, i) {
        if (entry.id.includes($("#search").val()) == true || entry.user_name.includes($("#search").val()) == true || entry.student_name.includes($("#search").val()) == true || entry.age.includes($("#search").val()) == true || entry.gender.includes($("#search").val()) == true || entry.starting_Date.includes($("#search").val()) == true || entry.ending_Date.includes($("#search").val()) == true || entry.plan_name.includes($("#search").val()) == true) {
          tempObjectstore.push(entry);
        };
      });
      data = tempObjectstore;
      dataGlobal = tempObjectstore;
      commonFunction(data);
      changeClickfunctionT();
    }
  };

  // Pagination function add pages, next, prev button in page
  function pagination(parameterPass) {
    if (parameterPass == true) {
      dataGlobal = tempObjectstore;
    }
    var pageNum = $("#page").val();
    var data = [];
    $("#tbody").empty();
    $("#addButton").empty();
    $("#addPrevbutton").empty();
    $("#addNextbutton").empty();
    x = dataGlobal.length;
    if (pageNum < x) {
      y = pageNum;
      if ((x % y) == 0) {
        z = (x / y);
      }
      else {
        z = Math.trunc(x / y) + 1;
      }
      $("#addPrevbutton").append('<button type="button" class="btn btn-warning" onclick="prevPage()">< Previous</button>');
      for (i = 1; i <= z; i++) {
        $("#addButton").append('<button type="button"  class="btn text-light" onclick="nextPage(' + i + ')">' + i + '</button>');
      }
      $("#addNextbutton").append('<button type="button" class="btn btn-warning" onclick="nextBtn()">Next ></button>');
      for (var i = 0; i < pageNum; i++) {
        data.push(dataGlobal[i]);
      }
      pageCount = 1;
      commonFunction(data);
    }
    else {
      data = dataGlobal;
      commonFunction(data)
    }
    changeClickfunctionT();
    tempObjectstore = data;
    $('#search').attr("onkeyup", "find(true)");
  }

  // Next page function
  function nextPage(parameterPass) {
    pageCount = parameterPass;
    pageData = [];
    $("#tbody").empty();
    j = ((parameterPass - 1) * $("#page").val());
    if (parameterPass == 1) {
      k = ($("#page").val() - 1);
    }
    else if ((j + parseInt($("#page").val())) > dataGlobal.length) {
      k = (dataGlobal.length - 1);
    }
    else {
      k = ((parameterPass * $("#page").val()) - 1);
    }
    for (i = j; i <= k; i++) {
      pageData.push(dataGlobal[i]);
    }
    tempObjectstore = pageData;
    var data = pageData;
    commonFunction(data);
    changeClickfunctionT();
  }

  // Change the function parameter of assending and desending
  function changeClickfunctionT() {
    $('#idUp').attr("onclick", "idAscending(true)");
    $('#idDown').attr("onclick", "idDescending(true)");
    $('#usernameUp').attr("onclick", "usernameAscending(true)");
    $('#usernameDown').attr("onclick", "usernameDescending(true)");
    $('#studentnameUp').attr("onclick", "snameAscending(true)");
    $('#studentnameDown').attr("onclick", "snameDescending(true)");
    $('#userageUp').attr("onclick", "ageAscending(true)");
    $('#userageDown').attr("onclick", "ageDescending(true)");
    $('#usergenderUp').attr("onclick", "genderAscending(true)");
    $('#usergenderDown').attr("onclick", "genderDescending(true)");
    $('#sdateUp').attr("onclick", "sdateAscending(true)");
    $('#sdateDown').attr("onclick", "sdateDescending(true)");
    $('#edateUp').attr("onclick", "edateAscending(true)");
    $('#edateDown').attr("onclick", "edateDescending(true)");
    $('#pnameUp').attr("onclick", "pnameAscending(true)");
    $('#pnameDown').attr("onclick", "pnameDescending(true)");
  }

  // Comman data append with enties details function
  function commonFunction(data) {
    count = 0;
    for (var i = 0; i < data.length; i++) {
      var add = ("<tr><td>" + data[i].id + "</td><td>" + data[i].user_name + "</td><td>" + data[i].student_name + "</td><td>" + data[i].age + "</td><td>" + data[i].gender + "</td><td>" + data[i].starting_Date + "</td><td>" + data[i].ending_Date + "</td><td>" + data[i].plan_name + "</td></tr>");
      $("#tbody").append(add);
      count++;
    }
    $("#countRow").html('Showing 1 to ' + count + ' of ' + dataGlobal.length + ' entries (Total entries: ' + dataLength + ')');
  };

  // Next page button function
  function nextBtn() {
    if (pageCount == z) {
      pageCount = 0;
    }
    nextPage(pageCount + 1);
  };

  // Previous page button function
  function prevPage() {
    if (pageCount == 1) {
      pageCount = z + 1;
    }
    nextPage(pageCount - 1)
  };

  // Call the home page
  function backHome() {
    window.location.href = 'Home.html?' + userName;
  };
  
</script>